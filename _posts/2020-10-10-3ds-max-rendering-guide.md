---
layout: post
title:  "Руководство по использованию рендер-фермы на базе Microsoft Azure"
author: sergeype
tags: [ Azure, Batch, hpc, cad, 3dsmax ]
image: assets/users/sergeyperus/rendering-guide.png
featured: true
hidden: true
---

Целью данной статьи ставлю дать простое руководство для пользователей 3DS Max по рендерингу моделей на рендер ферме, созданной в Microsoft Azure

Процесс рендеринга выглядит как следующая последовательность:

1) Загрузка готовой модели в облачное хранилище  
2) Запуск рендеринга  
3) Скачивание результатов

Предполагается, что ферма уже создана и модель построена

## ПОДГОТОВКА

Необходимо установить [Azure Batch Explorer](https://azure.github.io/BatchExplorer/) и авторизоваться с помощью учетной записи, имеющей доступ к ферме. 
После этого можно начинать рендеринг готовой модели даже без установленного 3DS Max. Если же он установлен, можно установить для него [плагин](https://github.com/Azure/azure-batch-rendering/tree/master/plugins/3ds-max/) и запускать рендеринг напрямую. По сути, плагин будет запускать различные меню того же Batch Explorer, поэтому все руководство будет посвящено работе с ним напрямую

## ЗАГРУЗКА МОДЕЛИ

Необходимо создать в облачном хранилище папки, в которые будут загружаться проекты и откуда скачивать результаты рендеринга. 
Открываем пункт *Data*, затем *+* и выбираем *Empty File Group*. Хочу заметить, что не допускается использование пробелов ни в названии каталогов, ни в названии заданий на рендеринг. Заменяйте их символом *-*. Для удобства, назовите группу в соответствии со своим алиасом, например, *ivanov_input* для загрузки моделей, и вторую *ivanov_results* для результатов. Это полезно, если с этой же фермой работают и ваши коллеги


![Image](/assets/users/sergeyperus/new-filegroup.png)

Выбираем папку *ivanov_input* и по кнопке *+* справа от нее добавляем каталог с нашей моделью. Здесь отмечу, что могут быть проблемы, если папка с моделью содержит много вложенных папок с длинными русскими именами. После загрузки модели можно делать сколько угодно отрисовок, в том числе с разных камер/разных кадров если в сцене присутствует движение. Если вносите изменения в сцену - загрузите в папку измененные/добавленные файлы 

## РЕНДЕРИНГ

Модель загружена. Открываем меню *Gallery*, выбираем нужный шаблон. В нашем случае это будет *3ds Max*. Далее выбираем нужное действие. В нашем случае это *VRay or Arnold scene*. На выборе режима выбираем использование существующего пула *Run job with existing pool*.

Далее необходимо выбрать пул из существующих,
    - дать имя задаче, например *object1-default-camera-shot1*. Имя не должно совпадать с другой задачей
    - 

## СТАТЬЯ НЕ ЗАВЕРШЕНА